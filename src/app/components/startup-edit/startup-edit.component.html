<main>
  <div class="spinner">
    <mat-spinner *ngIf="isSelected | async; else sForm" mode="indeterminate" color="primary">
    </mat-spinner>
  </div>

  <ng-template #sForm>
    <form [formGroup]="startupForm">
      <div class="imageBlock">
        <!--<mat-card>-->
        <!--<img class="imgParametrs" src="/src/assets/images/Logo.png" alt="startupLogo">-->
        <!--</mat-card>-->

        <app-image-upload (valueChange)='getImageAsString($event)'></app-image-upload>
      </div>

      <div class="rightFromImageBlock">
        <table>
          <tr>

            <mat-form-field>
              <input matInput placeholder="Startup name" [formControlName]="'startupName'">
            </mat-form-field>

          </tr>
          <tr>
            <mat-form-field>
      <textarea matInput mat-autosize="" placeholder="Idea" [formControlName]="'idea'">
      </textarea>
            </mat-form-field>
          </tr>

          <tr>
            <mat-form-field>
              <input matInput placeholder="Sum of investment" [formControlName]="'sumOfInvestment'">
              <span matPrefix>$</span>
            </mat-form-field>
          </tr>
        </table>
        <button mat-raised-button=""> Load image</button>

      </div>

      <div class="block">
        <mat-form-field style="width: 100%">
      <textarea matInput mat-autosize="" placeholder="About project" [formControlName]="'aboutProject'">
      </textarea>
        </mat-form-field>
      </div>

      <div class="block">
        <mat-form-field style="width: 100%">
      <textarea matInput mat-autosize="" placeholder="Business plan" [formControlName]="'businessPlan'">
      </textarea>
        </mat-form-field>
      </div>


      <div class="blockText">
        <h3><b> Members:</b></h3>
      </div>


      <div>
        <mat-card style="width: 200px; margin-right: 15px; margin-top: 15px; margin-bottom: 15px">
          <mat-card-header>
            <div mat-card-avatar class="example-header-image"></div>
            <mat-card-title *ngIf="getAccount()!==null"> {{ getAccount().firstName }} <br/>
              {{getAccount().lastName}}
            </mat-card-title>
            <mat-card-title *ngIf="getAccount()===null"> UNKNOWN</mat-card-title>
            <mat-card-subtitle> LEADER</mat-card-subtitle>
          </mat-card-header>
        </mat-card>
      </div>


      <div *ngFor="let res of startupForm.get('startupResumes').value">
        <mat-card style="margin: 15px; width: 200px" *ngIf="res.status ==='accepted' ">
          <mat-card-header>
            <div mat-card-avatar class="example-header-image"></div>
            <mat-card-title> {{res.resume.account.firstName}}<br/> {{res.resume.account.lastName}}</mat-card-title>
            <mat-card-subtitle> {{res.resume.businessRole.businessRoleName}}</mat-card-subtitle>
            <mat-card-content>
              <i class="material-icons" style="cursor: pointer">
                delete
              </i>
            </mat-card-content>
          </mat-card-header>
        </mat-card>
      </div>

      <mat-divider style="width: 90%"></mat-divider>


      <div class="blockText" *ngIf="pendingResumes?.length !== 0">
        <h3><b> Pending members:</b></h3>
      </div>
      <div *ngIf="pendingResumes?.length !==0 ;else empty" >
        <div *ngFor="let res of pendingResumes">
          <mat-card style="width: 200px; margin-right: 30px; margin-top: 15px; margin-bottom: 15px"
                    *ngIf="res.status ==='pending' ">
            <mat-card-header>
              <div mat-card-avatar class="example-header-image"></div>
              <mat-card-title> {{res.resume.account.firstName}}<br/> {{res.resume.account.lastName}}</mat-card-title>
              <mat-card-subtitle> {{res.resume.businessRole.businessRoleName}}</mat-card-subtitle>
              <mat-card-content>
                <i class="material-icons" style="cursor: pointer">
                  delete
                </i>
              </mat-card-content>
            </mat-card-header>
          </mat-card>
        </div>
      </div>

      <ng-template #empty>
        <h5 style="margin-top: 20px"> No pending member at that moment </h5>
      </ng-template>

      <mat-divider style="width: 90%"></mat-divider>


      <div *ngIf="id!==null">
        <button mat-raised-button="" class="btnControl" (click)="updateStartup()" [disabled]="startupForm.invalid"> Save
        </button>
        <button mat-raised-button="" class="btnControl" (click)="goBack()"> Cancel</button>
      </div>

      <div *ngIf="id===null">
        <button mat-raised-button="" class="btnControl" [disabled]="startupForm.invalid" (click)="createStartup()">
          Create
        </button>
        <button mat-raised-button="" class="btnControl" (click)="goBack()"> Cancel</button>
      </div>

    </form>
  </ng-template>

</main>
